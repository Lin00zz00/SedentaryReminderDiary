<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>æ¯æ—¥ä¹…åæƒ…å†µè°ƒæŸ¥</title>
    <script src="https://html2canvas.hertzen.com/dist/html2canvas.min.js"></script>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, "Helvetica Neue", Arial, sans-serif;
        }

        body {
            background: linear-gradient(135deg, #f5f7fa 0%, #c3cfe2 100%);
            min-height: 100vh;
            padding: 20px;
            color: #333;
        }

        .container {
            max-width: 600px;
            margin: 0 auto;
            background: white;
            border-radius: 20px;
            padding: 25px;
            box-shadow: 0 10px 20px rgba(0,0,0,0.1);
        }

        .header {
            text-align: center;
            margin-bottom: 30px;
        }

        .header h1 {
            color: #2c3e50;
            font-size: 24px;
            margin-bottom: 10px;
        }

        .question {
            margin-bottom: 30px;
            background: #f8f9fa;
            padding: 20px;
            border-radius: 15px;
            transition: transform 0.2s;
        }

        .question:hover {
            transform: translateY(-2px);
        }

        .question-title {
            font-size: 18px;
            color: #2c3e50;
            margin-bottom: 15px;
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .options {
            display: flex;
            flex-direction: column;
            gap: 12px;
        }

        .option {
            background: white;
            padding: 15px;
            border-radius: 12px;
            border: 2px solid #e9ecef;
            cursor: pointer;
            transition: all 0.3s;
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .option:hover {
            border-color: #4CAF50;
            background: #f1f8e9;
        }

        .option.selected {
            border-color: #4CAF50;
            background: #e8f5e9;
        }

        .rating-options {
            display: flex;
            justify-content: space-between;
            gap: 10px;
        }

        .rating-option {
            flex: 1;
            text-align: center;
            padding: 10px;
            border-radius: 8px;
            cursor: pointer;
            transition: all 0.3s;
        }

        .rating-option.selected {
            background: #4CAF50;
            color: white;
        }

        .submit-btn {
            background: #4CAF50;
            color: white;
            border: none;
            padding: 15px 30px;
            border-radius: 25px;
            font-size: 18px;
            cursor: pointer;
            width: 100%;
            margin-top: 20px;
            transition: all 0.3s;
        }

        .submit-btn:hover {
            background: #45a049;
            transform: translateY(-2px);
        }

        .emoji {
            font-size: 24px;
        }

        @media (max-width: 480px) {
            .container {
                padding: 15px;
            }
            
            .question {
                padding: 15px;
            }
            
            .option {
                padding: 12px;
            }
        }

        #report-container {
            display: none;
            position: fixed;
            top: -9999px;
            left: -9999px;
            background: white;
            padding: 40px;
            border-radius: 20px;
            box-shadow: 0 10px 20px rgba(0,0,0,0.1);
            width: 600px;
            max-width: 90vw;
            z-index: 9999;
        }

        .report-header {
            text-align: center;
            margin-bottom: 40px;
            color: #2c3e50;
        }

        .report-header h1 {
            font-size: 28px;
            margin-bottom: 10px;
        }

        .report-content {
            font-size: 18px;
            line-height: 1.8;
            color: #333;
        }

        .report-item {
            margin-bottom: 20px;
            padding: 10px;
            background: #f8f9fa;
            border-radius: 10px;
        }

        .report-footer {
            margin-top: 40px;
            text-align: center;
            color: #666;
            font-size: 16px;
            padding: 20px;
            background: #f8f9fa;
            border-radius: 10px;
        }

        .loading {
            display: none;
            position: fixed;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            background: rgba(0,0,0,0.8);
            color: white;
            padding: 20px 40px;
            border-radius: 10px;
            z-index: 1000;
            font-size: 16px;
        }

        .other-input {
            width: 100%;
            padding: 10px;
            border: 1px solid #ddd;
            border-radius: 8px;
            margin-top: 10px;
            font-size: 14px;
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>ğŸ“… æ¯æ—¥ä¹…åæƒ…å†µè°ƒæŸ¥</h1>
        </div>

        <div class="question">
            <div class="question-title">ğŸ“ ä»Šå¤©æ˜¯å·¥ä½œæ—¥è¿˜æ˜¯ä¼‘æ¯æ—¥ï¼Ÿ</div>
            <div class="options">
                <div class="option" data-value="workday">ğŸ¢ å·¥ä½œæ—¥</div>
                <div class="option" data-value="restday">ğŸ–ï¸ ä¼‘æ¯æ—¥</div>
            </div>
        </div>

        <div class="question" id="duration-question">
            <div class="question-title">ğŸ“ ä¹…åæ—¶é•¿</div>
            <div class="options">
                <div class="option" data-value="less-than-3">ğŸ•’ 3å°æ—¶ä»¥ä¸‹</div>
                <div class="option" data-value="3-5">ğŸ•’ 3-5å°æ—¶</div>
                <div class="option" data-value="5-7">ğŸ•’ 5-7å°æ—¶</div>
                <div class="option" data-value="more-than-7">ğŸ•’ 7å°æ—¶ä»¥ä¸Š</div>
            </div>
        </div>

        <div class="question">
            <div class="question-title">ğŸ“ æ˜¯å¦æœ‰æ™ºèƒ½æ‰‹ç¯/æ‰‹æœºç­‰å®¢è§‚è®¾å¤‡ç›‘æµ‹ä¹…åæ—¶é—´ï¼Ÿ</div>
            <div class="options">
                <div class="option" data-value="yes">âœ… æ˜¯</div>
                <div class="option" data-value="no">âŒ å¦</div>
            </div>
        </div>

        <div class="question" id="device-duration-question" style="display: none;">
            <div class="question-title">ğŸ“ å®é™…æ£€æµ‹çš„ä¹…åæ—¶é•¿ï¼ˆæ™ºèƒ½è®¾å¤‡æ•°æ®ï¼‰</div>
            <div class="options">
                <div class="option" data-value="less-than-3">ğŸ•’ 3å°æ—¶ä»¥ä¸‹</div>
                <div class="option" data-value="3-5">ğŸ•’ 3-5å°æ—¶</div>
                <div class="option" data-value="5-7">ğŸ•’ 5-7å°æ—¶</div>
                <div class="option" data-value="more-than-7">ğŸ•’ 7å°æ—¶ä»¥ä¸Š</div>
            </div>
        </div>

        <div class="question">
            <div class="question-title">ğŸ“ ä»Šå¤©å¯¼è‡´ä½ ä¹…åçš„ä¸»è¦åŸå› æ˜¯ä»€ä¹ˆï¼Ÿï¼ˆå¯å¤šé€‰ï¼‰</div>
            <div class="options">
                <div class="option" data-value="meeting">ğŸ“Š ä¼šè®®æ— æ³•ä¸­æ–­</div>
                <div class="option" data-value="focus">ğŸ¯ ä¸“æ³¨å·¥ä½œå¿˜è®°æ—¶é—´</div>
                <div class="option" data-value="position">ğŸ’º æ— æ³•ç¦»å¼€å·¥ä½œä½ç½®</div>
                <div class="option" data-value="travel">ğŸš— é•¿æ—¶é—´äº¤é€šå·¥å…·æ—…è¡Œ</div>
                <div class="option" data-value="lazy">ğŸ˜´ æ‡’å¾—èµ·èº«</div>
                <div class="option" data-value="entertainment">ğŸ® æ²‰æµ¸äºå¨±ä¹ï¼ˆçœ‹å‰§ã€ç©æ¸¸æˆç­‰ï¼‰</div>
                <div class="option" data-value="mood">ğŸ˜” æƒ…ç»ªä½è½/ç–²åŠ³</div>
                <div class="option" data-value="other">ğŸ“ å…¶ä»–ï¼ˆè¯·æè¿°ï¼‰</div>
                <input type="text" class="other-input" placeholder="è¯·å…·ä½“è¯´æ˜..." style="display: none;">
            </div>
        </div>

        <div class="question">
            <div class="question-title">ğŸ“ ä»Šå¤©ä½ ä¸»åŠ¨èµ·èº«çš„æ¬¡æ•°ï¼ˆä¸åŒ…æ‹¬ä¸Šå•æ‰€ï¼‰</div>
            <div class="options">
                <div class="option" data-value="0">0æ¬¡</div>
                <div class="option" data-value="1-2">1-2æ¬¡</div>
                <div class="option" data-value="3-5">3-5æ¬¡</div>
                <div class="option" data-value="6-plus">6æ¬¡ä»¥ä¸Š</div>
            </div>
        </div>

        <div class="question">
            <div class="question-title">ğŸ“ ä»Šå¤©å› ä¹…åä½ æ˜¯å¦æ„Ÿåˆ°èº«ä½“ä¸é€‚ï¼Ÿ</div>
            <div class="rating-options">
                <div class="rating-option" data-value="0">ğŸ˜Œ æ— ä¸é€‚</div>
                <div class="rating-option" data-value="1">ğŸ˜ 1ï¼ˆè½»å¾®ä¸é€‚ï¼‰</div>
                <div class="rating-option" data-value="2">ğŸ˜¬ 2</div>
                <div class="rating-option" data-value="3">ğŸ˜£ 3</div>
                <div class="rating-option" data-value="4">ğŸ˜– 4</div>
                <div class="rating-option" data-value="5">ğŸ˜« 5ï¼ˆä¸¥é‡ä¸é€‚ï¼‰</div>
            </div>
        </div>

        <div class="question" id="pain-locations" style="display: none;">
            <div class="question-title">ğŸ“ ç–¼ç—›éƒ¨ä½ï¼ˆå¯å¤šé€‰ï¼‰</div>
            <div class="options">
                <div class="option" data-value="back">ğŸ”„ è…°éƒ¨</div>
                <div class="option" data-value="neck">ğŸ”„ é¢ˆéƒ¨</div>
                <div class="option" data-value="shoulder">ğŸ”„ è‚©è†€</div>
                <div class="option" data-value="eyes">ğŸ‘€ çœ¼ç›/è§†è§‰ç–²åŠ³</div>
                <div class="option" data-value="wrist">ğŸ”„ æ‰‹è…•/å‰è‡‚</div>
                <div class="option" data-value="legs">ğŸ¦µ è…¿éƒ¨</div>
                <div class="option" data-value="other">ğŸ“ å…¶ä»–ï¼ˆè¯·æè¿°ï¼‰</div>
                <input type="text" class="other-input" placeholder="è¯·å…·ä½“è¯´æ˜..." style="display: none;">
            </div>
        </div>

        <div class="question" id="emotions" style="display: none;">
            <div class="question-title">ğŸ“ æƒ…ç»ªæ ‡ç­¾ï¼ˆå¯é€‰ï¼‰</div>
            <div class="options">
                <div class="option" data-value="angry">ğŸ˜¡ çƒ¦èº</div>
                <div class="option" data-value="tired">ğŸ˜ ç–²åŠ³</div>
                <div class="option" data-value="pain">ğŸ˜– ç—›è‹¦</div>
                <div class="option" data-value="anxious">ğŸ˜© ç„¦è™‘</div>
                <div class="option" data-value="numb">ğŸ˜ éº»æœ¨</div>
                <div class="option" data-value="happy">ğŸ˜Š è½»æ¾</div>
                <div class="option" data-value="relaxed">ğŸ˜… æ”¾æ¾</div>
            </div>
        </div>

        <div class="question">
            <div class="question-title">ğŸ“ ä»Šå¤©ä½ åœ¨å·¥ä½œä¸­/å­¦ä¹ ä¸­ä½¿ç”¨äº†ä»€ä¹ˆæ–¹æ³•æ¥ç¼“è§£èº«ä½“ä¸é€‚ï¼ˆå¦‚æœ‰ï¼‰ï¼Ÿ</div>
            <div class="options">
                <div class="option" data-value="stand">ğŸ”„ ç«™ç«‹/èµ°åŠ¨</div>
                <div class="option" data-value="stretch">ğŸ§˜ åšä¼¸å±•è¿åŠ¨</div>
                <div class="option" data-value="cushion">ğŸ’º ä½¿ç”¨èˆ’é€‚åå«æˆ–è°ƒæ•´åå§¿</div>
                <div class="option" data-value="other">ğŸ“ å…¶ä»–ï¼ˆè¯·æè¿°ï¼‰</div>
                <input type="text" class="other-input" placeholder="è¯·å…·ä½“è¯´æ˜..." style="display: none;">
            </div>
        </div>

        <div class="question">
            <div class="question-title">ğŸ’­ æƒ³è¯´çš„è¯</div>
            <textarea class="other-input" 
                      placeholder="æœ‰ä»€ä¹ˆæƒ³è¯´çš„éƒ½å¯ä»¥å†™åœ¨è¿™é‡Œ..." 
                      id="additional-thoughts" 
                      style="height: 100px; resize: vertical;"
                      rows="4"></textarea>
        </div>

        <button class="submit-btn" onclick="generateAndDownload()">ç”ŸæˆæŠ¥å‘Šå¹¶ä¸‹è½½</button>
    </div>

    <div id="report-container">
        <div class="report-header">
            <h1>ğŸ“… æ¯æ—¥ä¹…åæƒ…å†µæŠ¥å‘Š</h1>
        </div>
        <div class="report-content">
            <div class="report-item" id="report-date"></div>
            <div class="report-item" id="report-time"></div>
            <div class="report-item" id="report-day-type"></div>
            <div class="report-item" id="report-duration"></div>
            <div class="report-item" id="report-device"></div>
            <div class="report-item" id="report-reasons"></div>
            <div class="report-item" id="report-standup"></div>
            <div class="report-item" id="report-discomfort"></div>
            <div class="report-item" id="report-pain"></div>
            <div class="report-item" id="report-emotions"></div>
            <div class="report-item" id="report-solutions"></div>
            <div class="report-item" id="report-additional-thoughts"></div>
        </div>
        <div class="report-footer">
            ğŸ’ æ¸©é¦¨æç¤ºï¼šè®°å¾—é€‚æ—¶èµ·èº«æ´»åŠ¨ï¼Œä¿æŒå¥åº·å“¦ï¼
        </div>
    </div>

    <div class="loading">æ­£åœ¨ç”ŸæˆæŠ¥å‘Šå›¾ç‰‡...</div>

    <script>
        const valueMappings = {
            dayType: {
                workday: 'ğŸ¢ å·¥ä½œæ—¥',
                restday: 'ğŸ–ï¸ ä¼‘æ¯æ—¥'
            },
            duration: {
                'less-than-3': 'ğŸ•’ 3å°æ—¶ä»¥ä¸‹',
                '3-5': 'ğŸ•’ 3-5å°æ—¶',
                '5-7': 'ğŸ•’ 5-7å°æ—¶',
                'more-than-7': 'ğŸ•’ 7å°æ—¶ä»¥ä¸Š'
            },
            hasDevice: {
                yes: 'âœ… æ˜¯',
                no: 'âŒ å¦'
            },
            reasons: {
                meeting: 'ğŸ“Š ä¼šè®®æ— æ³•ä¸­æ–­',
                focus: 'ğŸ¯ ä¸“æ³¨å·¥ä½œå¿˜è®°æ—¶é—´',
                position: 'ğŸ’º æ— æ³•ç¦»å¼€å·¥ä½œä½ç½®',
                travel: 'ğŸš— é•¿æ—¶é—´äº¤é€šå·¥å…·æ—…è¡Œ',
                lazy: 'ğŸ˜´ æ‡’å¾—èµ·èº«',
                entertainment: 'ğŸ® æ²‰æµ¸äºå¨±ä¹',
                mood: 'ğŸ˜” æƒ…ç»ªä½è½/ç–²åŠ³',
                other: 'ğŸ“ å…¶ä»–'
            },
            standUpTimes: {
                '0': '0æ¬¡',
                '1-2': '1-2æ¬¡',
                '3-5': '3-5æ¬¡',
                '6-plus': '6æ¬¡ä»¥ä¸Š'
            },
            painLocations: {
                back: 'ğŸ”„ è…°éƒ¨',
                neck: 'ğŸ”„ é¢ˆéƒ¨',
                shoulder: 'ğŸ”„ è‚©è†€',
                eyes: 'ğŸ‘€ çœ¼ç›/è§†è§‰ç–²åŠ³',
                wrist: 'ğŸ”„ æ‰‹è…•/å‰è‡‚',
                legs: 'ğŸ¦µ è…¿éƒ¨',
                other: 'ğŸ“ å…¶ä»–'
            },
            emotions: {
                angry: 'ğŸ˜¡ çƒ¦èº',
                tired: 'ğŸ˜ ç–²åŠ³',
                pain: 'ğŸ˜– ç—›è‹¦',
                anxious: 'ğŸ˜© ç„¦è™‘',
                numb: 'ğŸ˜ éº»æœ¨',
                happy: 'ğŸ˜Š è½»æ¾',
                relaxed: 'ğŸ˜… æ”¾æ¾'
            },
            solutions: {
                stand: 'ğŸ”„ ç«™ç«‹/èµ°åŠ¨',
                stretch: 'ğŸ§˜ åšä¼¸å±•è¿åŠ¨',
                cushion: 'ğŸ’º ä½¿ç”¨èˆ’é€‚åå«æˆ–è°ƒæ•´åå§¿',
                other: 'ğŸ“ å…¶ä»–'
            }
        };

        document.querySelectorAll('.option').forEach(option => {
            option.addEventListener('click', function() {
                const parent = this.parentElement;
                if (parent.classList.contains('options')) {
                    this.classList.toggle('selected');
                } else {
                    parent.querySelectorAll('.option').forEach(opt => opt.classList.remove('selected'));
                    this.classList.add('selected');
                }

                // å¤„ç†å…¶ä»–é€‰é¡¹è¾“å…¥æ¡†
                if (this.dataset.value === 'other') {
                    const input = this.nextElementSibling;
                    if (input && input.classList.contains('other-input')) {
                        input.style.display = this.classList.contains('selected') ? 'block' : 'none';
                    }
                }

                handleConditionalDisplay();
            });
        });

        document.querySelectorAll('.rating-option').forEach(option => {
            option.addEventListener('click', function() {
                const parent = this.parentElement;
                parent.querySelectorAll('.rating-option').forEach(opt => opt.classList.remove('selected'));
                this.classList.add('selected');
                handleConditionalDisplay();
            });
        });

        function handleConditionalDisplay() {
            // å¤„ç†æ™ºèƒ½è®¾å¤‡ç›‘æµ‹é—®é¢˜
            const deviceQuestion = document.querySelector('.question:nth-of-type(3)');
            const deviceDurationQuestion = document.getElementById('device-duration-question');
            const deviceYesOption = deviceQuestion.querySelector('[data-value="yes"]');
            
            if (deviceYesOption && deviceYesOption.classList.contains('selected')) {
                deviceDurationQuestion.style.display = 'block';
            } else {
                deviceDurationQuestion.style.display = 'none';
            }

            // å¤„ç†ä¸é€‚ç¨‹åº¦ç›¸å…³çš„é—®é¢˜
            const discomfortQuestion = document.querySelector('.question:nth-of-type(7)');
            const painLocations = document.getElementById('pain-locations');
            const emotions = document.getElementById('emotions');
            const selectedDiscomfort = discomfortQuestion.querySelector('.rating-option.selected');
            
            if (selectedDiscomfort && parseInt(selectedDiscomfort.dataset.value) >= 2) {
                painLocations.style.display = 'block';
                emotions.style.display = 'block';
            } else {
                painLocations.style.display = 'none';
                emotions.style.display = 'none';
            }
        }

        function getSelectedValue(selector) {
            const selected = document.querySelector(`${selector}.selected`);
            console.log(`é€‰æ‹©å™¨ ${selector} çš„ç»“æœ:`, selected);
            if (!selected) return '';
            const value = selected.textContent.trim();
            console.log(`è·å–åˆ°çš„å€¼: ${value}`);
            return value;
        }

        function getSelectedValues(selector) {
            const elements = document.querySelectorAll(`${selector}.selected`);
            console.log(`é€‰æ‹©å™¨ ${selector} æ‰¾åˆ°çš„å…ƒç´ :`, elements);
            const values = Array.from(elements).map(el => el.textContent.trim());
            console.log(`è·å–åˆ°çš„å€¼æ•°ç»„:`, values);
            return values;
        }

        async function generateAndDownload() {
            console.log('å¼€å§‹ç”ŸæˆæŠ¥å‘Š...');
            
            // è·å–æ‰€æœ‰é—®é¢˜çš„ç­”æ¡ˆ
            const answers = {
                dayType: getSelectedValue('.question:nth-of-type(1) .option'),
                duration: getSelectedValue('#duration-question .option'),
                hasDevice: getSelectedValue('.question:nth-of-type(3) .option'),
                deviceDuration: getSelectedValue('#device-duration-question .option'),
                reasons: getSelectedValues('.question:nth-of-type(5) .option'),
                standUpTimes: getSelectedValue('.question:nth-of-type(6) .option'),
                discomfortLevel: getSelectedValue('.question:nth-of-type(7) .rating-option'),
                painLocations: getSelectedValues('#pain-locations .option'),
                emotions: getSelectedValues('#emotions .option'),
                solutions: getSelectedValues('.question:nth-of-type(8) .option'),
                additionalThoughts: document.getElementById('additional-thoughts').value
            };

            console.log('æ”¶é›†åˆ°çš„æ‰€æœ‰ç­”æ¡ˆ:', answers);

            // å¤„ç†å…¶ä»–é€‰é¡¹çš„æ–‡æœ¬
            const otherReasonInput = document.querySelector('.question:nth-of-type(5) .other-input');
            const otherSolutionInput = document.querySelector('.question:nth-of-type(8) .other-input');
            
            console.log('å…¶ä»–åŸå› è¾“å…¥æ¡†:', otherReasonInput);
            console.log('å…¶ä»–è§£å†³æ–¹æ¡ˆè¾“å…¥æ¡†:', otherSolutionInput);
            
            if (answers.reasons.includes('ğŸ“ å…¶ä»–ï¼ˆè¯·æè¿°ï¼‰') && otherReasonInput && otherReasonInput.value) {
                console.log('å¤„ç†å…¶ä»–åŸå› :', otherReasonInput.value);
                const index = answers.reasons.indexOf('ğŸ“ å…¶ä»–ï¼ˆè¯·æè¿°ï¼‰');
                answers.reasons[index] = otherReasonInput.value;
            }
            
            if (answers.solutions.includes('ğŸ“ å…¶ä»–ï¼ˆè¯·æè¿°ï¼‰') && otherSolutionInput && otherSolutionInput.value) {
                console.log('å¤„ç†å…¶ä»–è§£å†³æ–¹æ¡ˆ:', otherSolutionInput.value);
                const index = answers.solutions.indexOf('ğŸ“ å…¶ä»–ï¼ˆè¯·æè¿°ï¼‰');
                answers.solutions[index] = otherSolutionInput.value;
            }

            // è·å–å½“å‰æ—¥æœŸå’Œæ—¶é—´
            const now = new Date();
            const dateStr = now.toLocaleDateString('zh-CN', {
                year: 'numeric',
                month: 'long',
                day: 'numeric',
                weekday: 'long'
            });
            const timeStr = now.toLocaleTimeString('zh-CN', {
                hour: '2-digit',
                minute: '2-digit',
                second: '2-digit',
                hour12: false
            });

            // ç”ŸæˆæŠ¥å‘Šæ–‡æœ¬
            const reportText = `
ğŸ“… æ¯æ—¥ä¹…åæƒ…å†µæŠ¥å‘Š

ğŸ“† è®°å½•æ—¥æœŸï¼š${dateStr}
â° è®°å½•æ—¶é—´ï¼š${timeStr}
ğŸ“… æ—¥æœŸç±»å‹ï¼š${answers.dayType || 'æœªé€‰æ‹©'}
ğŸ“ ä¹…åæ€»æ—¶é•¿ï¼š${answers.duration || 'æœªé€‰æ‹©'}
ğŸ“± æ™ºèƒ½è®¾å¤‡ç›‘æµ‹ï¼š${answers.hasDevice === 'âœ… æ˜¯' ? `æ˜¯ï¼ˆ${answers.deviceDuration || 'æœªé€‰æ‹©'}ï¼‰` : 'å¦'}
ğŸ“ ä¹…ååŸå› ï¼š${answers.reasons.length > 0 ? answers.reasons.join('ã€') : 'æœªé€‰æ‹©'}
ğŸ“ ä¸»åŠ¨èµ·èº«æ¬¡æ•°ï¼š${answers.standUpTimes || 'æœªé€‰æ‹©'}
ğŸ˜£ èº«ä½“ä¸é€‚ç¨‹åº¦ï¼š${answers.discomfortLevel || 'æœªé€‰æ‹©'}
${answers.painLocations.length > 0 ? `ğŸ”„ ç–¼ç—›éƒ¨ä½ï¼š${answers.painLocations.join('ã€')}` : ''}
${answers.emotions.length > 0 ? `ğŸ˜Š æƒ…ç»ªæ ‡ç­¾ï¼š${answers.emotions.join('ã€')}` : ''}
ğŸ’ª ç¼“è§£æ–¹æ³•ï¼š${answers.solutions.length > 0 ? answers.solutions.join('ã€') : 'æœªé€‰æ‹©'}
ğŸ’­ æƒ³è¯´çš„è¯ï¼š${answers.additionalThoughts || 'æ— '}

ğŸ’ æ¸©é¦¨æç¤ºï¼šè®°å¾—é€‚æ—¶èµ·èº«æ´»åŠ¨ï¼Œä¿æŒå¥åº·å“¦ï¼
            `.trim();

            console.log('ç”Ÿæˆçš„æŠ¥å‘Šæ–‡æœ¬:', reportText);

            // åˆ›å»ºå¹¶ä¸‹è½½æ–‡æœ¬æ–‡ä»¶
            const blob = new Blob([reportText], { type: 'text/plain;charset=utf-8' });
            const a = document.createElement('a');
            a.href = URL.createObjectURL(blob);
            a.download = `ä¹…åæƒ…å†µæŠ¥å‘Š_${dateStr.replace(/\s+/g, '_')}_${timeStr.replace(/:/g, '-')}.txt`;
            document.body.appendChild(a);
            a.click();
            document.body.removeChild(a);
            URL.revokeObjectURL(a.href);

            // æ˜¾ç¤ºåˆ†äº«é€‰é¡¹
            setTimeout(() => {
                const shareDialog = document.createElement('div');
                shareDialog.style.cssText = `
                    position: fixed;
                    top: 50%;
                    left: 50%;
                    transform: translate(-50%, -50%);
                    background: white;
                    padding: 20px;
                    border-radius: 15px;
                    box-shadow: 0 5px 15px rgba(0,0,0,0.2);
                    z-index: 1000;
                    text-align: center;
                `;
                shareDialog.innerHTML = `
                    <h3 style="margin-bottom: 15px;">åˆ†äº«åˆ°å¾®ä¿¡</h3>
                    <p style="margin-bottom: 15px;">æŠ¥å‘Šå·²ç”Ÿæˆï¼Œè¯·å¤åˆ¶ä»¥ä¸‹å†…å®¹åˆ†äº«ï¼š</p>
                    <textarea style="width: 100%; height: 200px; margin-bottom: 15px; padding: 10px; border: 1px solid #ddd; border-radius: 5px;">${reportText}</textarea>
                    <button onclick="navigator.clipboard.writeText('${reportText.replace(/'/g, "\\'")}').then(() => alert('å·²å¤åˆ¶åˆ°å‰ªè´´æ¿ï¼'))" 
                            style="background: #07C160; color: white; border: none; padding: 10px 20px; border-radius: 5px; cursor: pointer;">
                        å¤åˆ¶å†…å®¹
                    </button>
                    <button onclick="this.parentElement.remove()" 
                            style="background: #f5f5f5; color: #666; border: none; padding: 10px 20px; border-radius: 5px; cursor: pointer; margin-left: 10px;">
                        å…³é—­
                    </button>
                `;
                document.body.appendChild(shareDialog);
            }, 1000);
        }
    </script>
</body>
</html>